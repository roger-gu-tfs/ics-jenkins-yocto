version: "3.7"
services:
  jenkins:
    image: "jenkins/jenkins:2.319.1-lts"
    container_name: jenkins
    ports:
      - 8080:8080
      - 50000:50000
    volumes:
      - /home/thermo/WorkDir/VerProj/jenkins_home:/var/jenkins_home/
  yocto:
    build: 
      context: ./Dockerfile
      dockerfile: Dockerfile_vertumnus_yocto
    image: ics/vertumnus-yocto
    container_name: yocto-sumo
    #ports:
    #  - "5000:5000"
    privileged: true
    volumes:
       - ~/.ssh:/home/ics/.ssh
       - ~/.gitconfig:/home/ics/.gitconfig
       - /usr/src:/usr/src
       - /lib/modules:/lib/modules
       - /linux-kernel:/linux-kernel
       - ~/WorkDir/VerProj/yocto_build:/workdir/
       - /opt/yocto_shared:/opt/yocto_sumo_shared
    environment:
      - yocto_dl=/opt/yocto_shared
      - HOST_USER_GID=ics
      - HOST_USER_GID=ics
    #entrypoint: ["/usr/sbin/init"]    
  portainer:
    image: portainer/portainer-ce:latest
    container_name: portainer
    restart: unless-stopped
    security_opt:
      - no-new-privileges:true
    volumes:
      - /etc/localtime:/etc/localtime:ro
      - /var/run/docker.sock:/var/run/docker.sock:ro
      - ./portainer-data:/data
    ports:
      - 9000:9000
      
volumes:
  logvolume01: {}
